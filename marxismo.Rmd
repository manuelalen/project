---
title: "Validaciones emp칤ricas de la teor칤a marxista"
author: "Manuel Al칠n - manualen@protonmail.com"
date: 'Creado: 2022-12-03'
output: html_document
---
```{r echo = FALSE}
library(knitr)
# Color text
colorize <- function(x, color) {
  
  if (knitr::is_latex_output()) {
    
    sprintf("\\textcolor{%s}{%s}", color, x)
    
  } else if (knitr::is_html_output()) {
    
    sprintf("<span style='color: %s;'>%s</span>", color, x)
    
  } else { x }
}
```

```{r echo = FALSE, include = FALSE, chunk-1}
library(ggplot2)
library(tidyverse)
library(skimr)
library(RMySQL)
library(plotly)
library(metafor)
library(dplyr)
library(DT)

## Experiencia laboral Dataset
df_plusvalia <- data.frame(
  A침o <- c(seq(2002,2019)),
  Tasa_Plusvalia <- c(131.42,118.77,125.58,121.62,118.72,128.69,128.39,122.36,124.85,119.20,112.10,122.86,132.64,
                      138.17,128.89,134.84,135.46,117.04),
  Tasa_Ganancia <- c(24.50,22.09,22.81,21.55,20.80,23.04,25.01,26.43,25.73,24.25,22.01,23.96,25.64,
                     27.49,26.14,27.05,27.05,31.66),
  Ciclos_Capital <- c(6.68,6.56,6.76,6.86,6.90,6.87,6.42,5.85,6.10,6.11,6.21,6.36,6.50,6.41,6.22,6.33,6.36,5.87))

colnames(df_plusvalia) <- c("A침o","Tasa_Plusvalia","Tasa_Ganancia","Ciclos_Capital")


gg_plusvalia <- ggplot(df_plusvalia,aes(x=A침o,group=1))+
  geom_line(aes(y=Tasa_Plusvalia,colour="red"))+
  geom_line(aes(y=Tasa_Ganancia,colour="#23cd59"))+
  theme_light()+
  theme_minimal()+
  theme(text = element_text(family = "Tahoma"),
        panel.background = element_rect(color = "white", # Border color
                                        size = 1, fill = "#FFFFFF"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(face = "bold",hjust = 0.5,size = 25),
        plot.subtitle = element_text(hjust = 0.5),
        plot.title.position = "plot" ,
        panel.border = element_blank(),
        axis.text = element_text(size=7),
        axis.line = element_line(colour = "black"),
        legend.position = "none")+
  labs(title = "Tasa de Plusvalia y de ganancia por a침o",
       caption = "Author: Manuel Al칠n S치nchez",
       x = "A침o", y="Tasas")


ggGaugeAcierto <- plot_ly(
  domain = list(x=c(0,1), y = c(0,1)),
  value = 99.28,
  title = "Acierto en predicci칩n de producci칩n 'marxista' frente a 'capitalista'",
  type = "indicator",
  mode = "gauge+number",
  gauge = list(
    axis = list(range = list(NULL,100)),
    steps = list(range = c(0,99.28), color = "lightgreen"),
    threshold = list(
      line = list(color = "red", width = 4),
      thickness = 0.75,
      value = 100) 
  )
)
```




# Prefacio {-}

Esta gu칤a ha sido dise침ado por [Manuel Al칠n S치nchez](https://twitter.com/alen_manu) y pensada para <mark>**desmentir bulos alrededor del marxismo**</mark>. Dicho manual ha sido elaborado a su vez en `R` con [{rmarkdown}](https://github.com/rstudio/rmarkdown). Tambi칠n se aportar치 todo el **c칩digo** de esta gu칤a en mi [GitHub](https://github.com/manuelalen).

## Licencia {-}

[![Licencia: GPLv3](img/license-GPLv3-blue.png)](https://www.gnu.org/licenses/gpl-3.0)

Este documento es publicado bajo **licencia p칰blica general GNU**,
una licencia libre de copyleft que garantiza a los usuarios finales (personas, organizaciones, compa침칤as) la **libertad de usar, estudiar, compartir (copiar) y modificar el software. Por cuestiones personales e idoel칩gicas, no es necesario citar el contenido de esta gu칤a.** 

## Sobre el autor {-}

> 游꿗 Hola! Mi nombre es <mark>**Manuel Al칠n S치nchez**</mark>. Un gusto, un placer

Me dedico tanto al <mark>Business Intelligence </mark> como a la <mark>**visualizaci칩n de datos utilizando Power BI**</mark>. No obstante, por temas de estad칤stica, prefiero el lenguaje `R`. Tengo titulaci칩n en <mark>administraci칩n de sistemas inform치ticos y redes</mark> adem치s de estar cursando el Grado de Econom칤a por la [Uned](https://www.uned.es/universidad/inicio.html). En Twitter me encontrar칠is compartiendo memes, enfad치ndome y haciendo hilos sobre estad칤stica aplicada a la vida diaria.


游냕 [Twitter](https://twitter.com/alen_manu)  
游냠 [GitHub](https://github.com/manuelalen)    
游닑 [Correo](mailto:manualen@protonmail.com)

## Prop칩sito {-}

El <mark>**objetivo**</mark> principal de este documento es mostrar cu치nto se miente sobre el marxismo, demostrando varios puntos de la misma. No obstante, tambi칠n se someter치 a revisi칩n sistem치tica la teor칤a y se detallar치n los puntos de la misma que ya no sean correcta.

Todo lo aqu칤 detallado, se podr치 encontrar en las <mark>**Fuentes**</mark> 


## 游닄 Conceptos b치sicos para empezar {-}

* 游뚮 <strong>`r colorize("쯈u칠 es la plusval칤a?","#120cf3")`</strong>: Cualquier persona trabajadora puede entender, que las empresas buscan beneficio. Para esto, los trabajadores producen unas mercanc칤as que, al tener valor de cambio, se venden por dinero. As칤 pues, los trabajadores producen una cantidad determinada de dinero, pero para que la empresa obtenga beneficio, es vital que el salario de los trabajadores sea menor a la producci칩n medida en unidades monetarias. Eso es la plusval칤a, esa diferencia entre lo que se trabaja/produce menos el material que la empresa utiliza para producir, los impuestos y el salario de los trabajadores. Su f칩rmula, tal y como se detalla en El Capital de Karl Marx es la siguiente:

$$
P = M - K_{c} - K_{v} - T
$$

Donde `P` es la <mark><strong>Plusvalia</strong></mark>, `M` son las <mark><strong>mercanc칤as vendidas</strong></mark> y medidas en unidades monetarias, `Kc` es el <mark><strong>capital constante</strong></mark> (m치quinas, f치bricas, ordenadores, etc medido en unidades monetarias), `Kv` es el <mark><strong>capital variable</strong></mark> (salarios) y `T` son los <mark><strong>impuestos pagados</strong></mark> (pues en las mercanc칤as se mete el valor con los impuestos)

* 游눶<strong>`r colorize("쯈u칠 es la tasa de plusval칤a?","#120cf3")`</strong>: Si la plusval칤a es lo que el empresario "roba" al trabajador de lo que produce, la tasa de plusval칤a ser칤a el porcentaje de cu치nto le quita. Para los <mark><strong>marxistas, esto es tasa de explotaci칩n</strong></mark>. Esta variable la podemos medir con la siguiente expresi칩n.

$$
T_{p} = \frac{P}{K_{v}}
$$

* 游뱀 <strong>`r colorize("쯈u칠 es la tasa de ganancia?","#120cf3")`</strong>: La tasa de ganancia para los marxista ser칤a la rentabilidad que se obtendr칤a del capital. La podemos medir con la siguiente expresi칩n. 

$$
T_{g} = \frac{P}{(K_{c}+K_{v})}
$$


* 驕뮖잺<strong>`r colorize("쯈u칠 son los ciclos del capital?","#120cf3")`</strong>: Creo que cualquier persona ha ido a comprar a la t칤pica tienda de ropa que es muy barata, pero que la ropa dura muy poco. O alguno ha notado que la bater칤a de su m칩vil, al a침o, ya dura muy muy poco "obligando" casi a cambiar el m칩vil en lo que se conoce como obsolescencia programada. Esta es una consecuencia de los ciclos del capital, un elemento que necesita el capitalosmo para generar beneficios.

> Cualquier marxista recordar치 el siguiente esquema de circulaci칩n del capital

> D - M - D'

> B치sicamente que el capitalista utiliza el dinero para, comprando fuerza de trabajo, generar mercanc칤as que le permitan obtener m치s dinero. 

Pues los ciclos del capital ser칤a cu치ntas veces una empresa (y en conjunto) necesita repetir este esquema para generar las ganancias deseadas. Lo podemos expresar con la siguiente f칩rmula:

$$
C = 1 + A_{k} + T_{p}
$$


## 游뿮 Comprobar el acierto entre la estimaci칩n de la producci칩n utilizando la teor칤a marxista y la producci칩n realmente obtenida.

<details>
<summary><strong>Acierto en porcentaje de la producci칩n estimada con respecto a la realmente obtenida</strong>
</summary>
```{r echo=FALSE,warning=FALSE,out.width="110%", gauge-graph}
ggGaugeAcierto
```
</details>


## 游댣 Gr치fica de tasa de plusvalia y tasa de ganancia {#grafica1}

(haz click en las flechas para ver la gr치fica)


<details>
  <summary><strong>Gr치fica de tasa de plusvalia y tasa de ganancia</strong>: 
  
</summary>
  
```{r echo=FALSE,warning=FALSE,out.width="110%", compe_graph}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
ggplotly(gg_plusvalia,tooltip =c("x","y","fill"))
```

</details>


Pero 쮿asta qu칠 punto replica/correlaciona la tasa de plusvalia con la tasa de ganancia?  Esto es algo que comprobaremos realizando, en primer lugar, las correlaciones.


## 游댍 Correlaciones entre la tasa de Plusval칤a y la Tasa de Ganancia. {#correlaciones-1}

<details>
  <summary><strong>Correlaciones entre la tasa de Plusval칤a y la Tasa de Ganancia</strong>: 
  
</summary>
```{r echo=FALSE,warning=FALSE,out.width="110%", means-0}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
summary(lm(df_plusvalia$Tasa_Plusvalia~df_plusvalia$Tasa_Ganancia)) 
```

</details>

En un principio no replica tal y como dice la teor칤a de la tendencia decreciente de la tasa de ganancia. No resulta significativo. Pero este se debe a que ambas replican entre s칤 con los ciclos del capital. Es decir, tendremos que controlar los ciclos del capital en nuestra medici칩n.

## 游늳 Gr치fica de dispersi칩n{#grafica2}

<details>
  <summary><strong>Gr치ficas de dispersi칩n</strong>: 
  
</summary>

```{r echo = FALSE, include = FALSE, dispersion-1}
ggDispersion <- ggplot(df_plusvalia,aes(x=Tasa_Ganancia,y=Tasa_Plusvalia))+
geom_point()+
geom_smooth(method=lm)+
 theme_light()+
  theme_minimal()+
  theme(text = element_text(family = "Tahoma"),
        panel.background = element_rect(color = "white", # Border color
                                        size = 1, fill = "#FFFFFF"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(face = "bold",hjust = 0.5,size = 25),
        plot.subtitle = element_text(hjust = 0.5),
        plot.title.position = "plot" ,
        panel.border = element_blank(),
        axis.text = element_text(size=7),
        axis.line = element_line(colour = "black"),
        legend.position = "none")+
  labs(
       x = "Tasa de Ganancia", y="Tasa de Plusvalia")



ggDispersion1 <- ggplot(df_plusvalia,aes(x=Tasa_Ganancia,y=Ciclos_Capital))+
geom_point()+
geom_smooth(method=lm)+
 theme_light()+
  theme_minimal()+
  theme(text = element_text(family = "Tahoma"),
        panel.background = element_rect(color = "white", # Border color
                                        size = 1, fill = "#FFFFFF"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(face = "bold",hjust = 0.5,size = 25),
        plot.subtitle = element_text(hjust = 0.5),
        plot.title.position = "plot" ,
        panel.border = element_blank(),
        axis.text = element_text(size=7),
        axis.line = element_line(colour = "black"),
        legend.position = "none")+
  labs(
       x = "Tasa de Ganancia", y="Ciclos del Capital")

```



```{r echo=FALSE,warning=FALSE,out.width="110%", dispersion-graph}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
ggplotly(ggDispersion,tooltip =c("x","y","fill"))
ggplotly(ggDispersion1,tooltip =c("x","y","fill"))
```

</details>

Al hacer esto, ya replica ambas variables, y esto es que se debe a que, a mayor ciclos de capital, mayores ganancias. Por esta misma raz칩n, empresas como Primark suelen tener ropa muy poco duraderas, para incitar a un mayor consumo una vez que se estropee la ropa. Esto le llevar치 a que la ropa dure menos para que la gente compre m치s y as칤 tengan m치s preobabilidad de beneficios. Es el mismo motivo que hace que exista la obsolescencia programada en dispositivos tecnol칩gicos.

## 游댍 Correlaciones entre la tasa de Plusval칤a y la Tasa de Ganancia controlando los ciclos del capital. {#correlaciones-2}
<details>
  <summary><strong>Correlaciones entre la tasa de Plusval칤a y la Tasa de Ganancia controlando los ciclos del capital</strong>: 
  
</summary>

```{r echo=FALSE,warning=FALSE,out.width="110%", means-1}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
summary(lm(df_plusvalia$Tasa_Plusvalia~df_plusvalia$Tasa_Ganancia+df_plusvalia$Ciclos_Capital)) 
```

</details>

&nbsp;




## 久쓆잺 Fuentes {-}

*游늿 [El Capital](http://www.archivochile.com/Marxismo/Marx%20y%20Engels/kmarx0012.pdf)

